<!DOCTYPE html>
<html lang="en">
<head>
	<title>Store Manager - Admin Dashboard</title>
	<link rel="stylesheet" type="text/css" href="css/style.css">
</head>
<body>
	<div class="main">
		<div class="login-info">
			<h2>Logged in as: Akinwale Samuel <a href="/" class="btn product-btn">Logout</a></h2>
		</div>
		<div class="dashboard">
			<div class="dash-options">
				<a href="dashboard" class="btn dash-btn">Dashboard</a>
				<a href="addproduct" class="btn dash-btn">Add Product</a>
				<a href="editproduct" class="btn dash-btn">Edit Product</a>
				<a href="deleteproduct" class="btn dash-btn">Delete Product</a>
				<a href="viewsales" class="btn dash-btn">View Sales</a>
				<a href="addattendant" class="btn dash-btn">Add Attendant</a>
				<a href="attendants" class="btn dash-btn">View Attendants</a>
			</div>
			<div class="product-available">
				<p id="showData"></p>

				<script type="text/javascript">
					const products = [];
					
					const url = '/api/v1/products';

					fetch(url)
					.then(data => {return data.json()})
					.then(products => {
						let col = [];
					        for (let i = 0; i < products.length; i++) {
					            for (let key in products[i]) {
					                if (col.indexOf(key) === -1) {
					                    col.push(key);
					                }
					            }
					        }

					        // CREATE DYNAMIC TABLE.
					        let table = document.createElement("table");

					        // CREATE HTML TABLE HEADER ROW USING THE EXTRACTED HEADERS ABOVE.

					        let tr = table.insertRow(-1);                   // TABLE ROW.

					        for (let i = 0; i < col.length; i++) {
					            let th = document.createElement("th");      // TABLE HEADER.
					            th.innerHTML = col[i];
					            tr.appendChild(th);
					        }

					        // ADD JSON DATA TO THE TABLE AS ROWS.
					        for (let i = 0; i < products.length; i++) {

					            tr = table.insertRow(-1);

					            for (let j = 0; j < col.length; j++) {
					                let tabCell = tr.insertCell(-1);
					                tabCell.innerHTML = products[i][col[j]];
					            }
					        }

					        // FINALLY ADD THE NEWLY CREATED TABLE WITH JSON DATA TO A CONTAINER.
					        let divContainer = document.getElementById("showData");
					        divContainer.innerHTML = "";
					        divContainer.appendChild(table);
					});

				</script>
			</div>
		</div>
	</div>
</body>
</html>